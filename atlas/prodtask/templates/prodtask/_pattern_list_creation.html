{% extends "prodtask/_index.html" %}
{% load url from future %}
{% load static from staticfiles %}
{% load js %}

{% block bl_title %}Core App of Monitoring{% endblock %}

{% block subtitle %}
{% if title %}{{ title }}{% else %}Datatable{% endif %}
{% endblock %}

{% block extra_css %}
{{ block.super }}
	<style type="text/css" title="currentStyle">
	    @import "{% static "css/jquery-ui-1.10.3.custom.min.css" %}";
        @import "{% static "css/jquery.dataTables_themeroller.css" %}";
        @import "{% static "css/prodtask.css" %}";
	</style>
    
    <style type="text/css">
        {% include 'prodtask/_prodtask_css.html' %}
    </style>

{% endblock %}

{% block base_js %}
{{ block.super }}


{% django_js %}
    <script type="text/javascript" src="{% static "js/jquery-ui-1.10.3.custom.min.js" %}"></script>
{% endblock %}

{% block extra_js %}
{{ block.super }}
    <script type="text/javascript" src="{% static "js/jquery.dataTables.min.js" %}"></script>
    <script type="text/javascript" src="{% static "js/libs/jquery-migrate-1.0.0.min.js" %}"></script>
    <script type="text/javascript" src="{% static "js/jquery.json-2.4.min.js" %}"></script>
    <script type="text/javascript" src="{% static "js/jquery.address-1.5.js" %}"></script>
{% endblock %}


{% block body %}
<style>
.Pattern {
    border:1px dotted black;
}
.PatternHeader {
    border:1px solid black;
}
</style>
    <script>
$(document).ready(function(){
        (function(){changePatternType('MCPatterns')})();

        });

        function changePatternType(patternType){
            $(".Pattern").hide();
            $("."+patternType).show();
        }

        function removePattern(event, trainID){
        {#            send remove command and remove pattern from the list if succesful#}
            event.preventDefault();

        }

        function addPattern(event, requestID){
            event.preventDefault();

            var sendData = {request_id:requestID,pattern_type:$('#patternType').val()};
            $.ajax({
                        url: "{% url 'prodtask:add_pattern_to_list'  %}",
                        type: 'POST',
                        contentType: 'application/json; charset=utf-8',
                        data: $.toJSON(sendData),
                        dataType: 'text',
                        success: function(data,status) {
                            var return_status =  $.evalJSON(data).success;
                            if(return_status){
                                alert('Added');
                            } else{
                                alert($.evalJSON(data).message);
                            }
                        }
                  });
        }
</script>
    <div class="row">
    <div class="large-2 column">
        <label>Pattern request for:<select id='patternType' onchange="changePatternType($(this).val())">
            <option value="MCPatterns" selected >MC</option>
            <option value="DataPatterns">Real data</option>
        </select></label>
        <div class="large-10 column"></div>
    </div>
        </div>
    <div class="row">

         <div class="large-3 column">
        <label> New pattern request
            <input id='patternRequest' type="number"/>
        </label>
              </div>
        <div class="large-1 column">
        <a class='button postfix' onclick="addPattern(event,$('#patternRequest').val())">Add</a>
            </div>
        <div class="large-9 column"></div>


    </div>


    <div class="large-10 column"></div>
    </div>

    <div class="row PatternHeader">
        <div class="large-2 column">
            <span>ID</span>
        </div>
        <div class="large-8 column">
            <span>Description</span>
        </div>
        <div class="large-2 column">
            <span>Action</span>
        </div>
    </div>
{% for pattern in mc_patterns %}
    <div class="row MCPatterns Pattern">
        <div class="large-2 column">
            {{ pattern.request_id  }}
        </div>
        <div class="large-8 column">
            {{ pattern.request_name  }}
        </div>
        <div class="large-2 column">
            <a id="removeButton{{ pattern.request_name  }}">remove</a>
        </div>
    </div>
{% endfor %}
    {% for pattern in data_patterns %}
    <div class="row DataPatterns Pattern">
        <div class="large-2 column">
            {{ pattern.request_id  }}
        </div>
        <div class="large-8 column">
            {{ pattern.request_name  }}
        </div>
        <div class="large-2 column">
            <a class="button" id="removeButton{{ pattern.request_name  }}" onclick="removePattern(event,'{{ pattern.train_id }}')">remove</a>
        </div>
    </div>
{% endfor %}
{% endblock %}